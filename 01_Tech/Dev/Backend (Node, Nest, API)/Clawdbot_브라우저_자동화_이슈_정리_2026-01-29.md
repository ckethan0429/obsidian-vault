# Clawdbot 브라우저 자동화 이슈 정리 (2026-01-29)

## 목표
- Threads 프로필(내 글/리포스트/좋아요)을 브라우저 자동화로 수집/정리하려고 함.

## 환경
- Host: ubuntu (linux 6.14.0-37-generic)
- Clawdbot: 2026.1.24-3
- Gateway: local, loopback, http/ws 포트 18789
- Browser control server: http://127.0.0.1:18791 (CDP 기본 18792)

## 증상
### 1) GUI 없는 환경에서 chromium 실행 실패
- `chromium` 실행 시:
  - `Missing X server or $DISPLAY`
  - `The platform failed to initialize. Exiting.`
- 의미: GUI/X server 없는 서버 환경에서 headful chromium을 실행하려 해서 실패.

### 2) Clawdbot browser tool이 프로필을 시작하지 못함
- `clawdbot browser start --browser-profile clawd` 시도 시 반복 오류:
  - `Error: Can't reach the clawd browser control server at http://127.0.0.1:18791/start?profile=clawd (timed out after 15000ms)`
- 관찰:
  - 포트 18791은 gateway가 LISTEN 중인 상태였으나(`/start`는 404로 보이거나 POST도 timeout)
  - `clawdbot browser status`는 `running: false`, `cdpReady: false` 상태가 지속

### 3) chrome 프로필이 Extension Relay 모드로 동작
- `clawdbot browser start --browser-profile chrome` 시도 시:
  - `Chrome extension relay is running, but no tab is connected. Click the Clawdbot Chrome extension icon on a tab to attach it (profile "chrome").`
- 의미: 현재 기본 프로필(chrome)은 로컬 chromium 실행이 아니라 **Browser Relay(확장)로 탭을 attach**해야 동작하는 모드로 보임.

## 시도한 조치
1) Chromium(snap) 설치/재설치
- `chromium --version` → `Chromium 144.0.7559.96 snap`

2) Headless 모드로 전환
- `clawdbot config set browser.headless true`
- Gateway restart 수행
- 결과: `browser.headless=true`는 반영되었으나 `clawd` 프로필 start timeout 지속

3) noSandbox 활성화
- `clawdbot config set browser.noSandbox true`
- Gateway restart 수행
- 결과: timeout 지속

## 현재 결론
- 서버(host)에서 headless Chromium을 직접 띄우는 경로가 현재 환경/설정에서 안정적으로 동작하지 않음.
- 단, Telegram 채널은 정상(ON/OK).

## 권장 해결 방향
### A) Browser Relay(추천)
- GUI 있는 PC의 Chrome에서 Threads를 열고 로그인한 뒤,
- Clawdbot Browser Relay 확장으로 해당 탭을 Attach해서
- 그 탭을 원격 제어해 수집하는 방식이 가장 안정적.

### B) 서버-side headless 안정화(추가 디버깅 필요)
- `clawdbot logs --follow`로 browser control server start/route 문제를 확인
- 필요 시 `clawdbot browser serve`를 별도 프로세스로 띄우고,
  프로필/CDP 포트 매핑 및 start 엔드포인트 동작 여부 점검
- (환경에 따라) sandbox browser(도커 기반) 사용도 고려

## 참고 메모
- 18791의 `/health`, `/status`는 기본적으로 404 (`Cannot GET ...`) 응답을 반환함.
- `/start`도 GET 404, POST는 timeout이 발생.
